<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:pe="http://primefaces.org/ui/extensions"
	template="template/ui.xhtml">
	<ui:define name="body">
		<ui:include src="./general/headerLoggedIn.xhtml" />
		<div class="analysisDiv">
			<h:form id="analysisForm">
				<div>
					<table width="100%">
						<tr>
							<td valign="top" width="20%">
								    <p:panel>
								    	<div class="analysisNewBuildingClass">
									    	<p:graphicImage width="12px" value="#{request.contextPath}/../resources/images/account.png" style="padding-right:5px"/>
											<p:commandLink value="Create Building" oncomplete="PF('newBuildingPopup').show()"></p:commandLink>    
										</div>
										<ui:repeat value="#{analysisBean.buildingsToShow}" var="building">
											 <p:panel styleClass="buildingPanelClass" id="toggleable" header="#{building.name}" collapsed="true" toggleable="true" toggleSpeed="500">
											    <p:treeTable id="docs" value="#{building.rootDivision}" var="division" selectionMode="single" >
											        <p:column>
											            <h:outputText value="#{division.name}" />
											        </p:column>
											        <p:ajax event="select"
															listener="#{analysisBean.selectDivision}"
															update="analysisForm"></p:ajax>
														<p:ajax event="unselect"
															listener="#{buildingManagementBean.hideDivisionOptions}"
															update="analysisForm"></p:ajax>
											    </p:treeTable>
											    <p:graphicImage width="12px" value="#{request.contextPath}/../resources/images/plus.png" style="padding-right:5px"/>
											    <p:commandLink styleClass="buildingLinks" value="Add Division"></p:commandLink>
											    <p:spacer width="15"></p:spacer>
											    <p:graphicImage width="12px" value="#{request.contextPath}/../resources/images/negative.png" style="padding-right:5px"/>
											    <p:commandLink styleClass="buildingLinks" value="Delete Building" ajax="true" update=":analysisForm"
											    			   action="#{analysisBean.deleteBuilding(building)}"></p:commandLink>
										     </p:panel>
										</ui:repeat>
									</p:panel>
							</td>
							<td valign="top">
								<div align="center" class="analaysisDateCss">
									<p:outputPanel>
										<p:panel>
										</p:panel>
									</p:outputPanel>
								</div>
							</td>

						</tr>
					</table>
				</div>
			</h:form>
			</div>
			<ui:include src="./general/footer.xhtml" />
			<ui:include src="./popups/newBuildingPopup.xhtml" />
	</ui:define>
</ui:composition>