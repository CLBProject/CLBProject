<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition
	PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core" xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core" template="template/ui.xhtml">
	<ui:define name="body">

		<div class="homeMainDivClass">
			<h:form id="bannerForm" class="headerForm header p-grid">
					<div class="p-col logo p-justify-center">
						<p:outputLabel >LEnergyLogo</p:outputLabel>
					</div>
					<div class="p-col loginForm">
						<div class="p-col username">
							<p:outputLabel for="username" class="userLabel">Username:</p:outputLabel>
							<p:inputText id="username" label="username" value="#{clbHomeLoginBean.loginUsername}" />
						</div>
						<div class="p-col password">
							<p:outputLabel for="passwordUser" class="passLabel">Password:</p:outputLabel>
							<p:inputText label="passwordUser" id="passwordUser" value="#{clbHomeLoginBean.loginPassword}"
								type="password" />
						</div>
						<div class="p-col loginButton">
							<p:commandButton  value="Log In" action="#{clbHomeLoginBean.loginUser}" ajax="true"
								update="@form" oncomplete="if (args.cantLoginUserNotFound === true )
										{ 
											PF('unSuccessPaneldoesnexistUnsuccess').show();
										}
										if (args.cantLoginPasswordDoesntMatch === true)
										{
											PF('unSuccessPanelpasswordnotmatchUnsuccess').show();
										}
										"></p:commandButton>
						</div>
					</div>
			</h:form>


			<div  class="p-grid p-col-align-center p-justify-around vertical-container">
				<h:form id="registerForm" class="registerForm"> 
					<p:panel header="Register Form">
							<div class="p-col-6">
								<p:outputLabel>Name</p:outputLabel>
								<p:inputText validatorMessage="Name too short!" requiredMessage="Name is required!" id="nameUser"
									value="#{clbHomeRegisterBean.user.name}" required="true" label="nameUser">
									<f:validateLength minimum="3"></f:validateLength>
								</p:inputText>
								<p:message for="nameUser" />
								</div>

								<div class="p-col-6">
										<p:outputLabel>Email</p:outputLabel>
										<p:inputText requiredMessage="Email is required!" validatorMessage="Email is not valid!"
											value="#{clbHomeRegisterBean.user.username}" required="true" label="emailUser" id="emailUser">
											<f:validateRegex pattern="[\w\.-]*[a-zA-Z0-9_]@[\w\.-]*[a-zA-Z0-9]\.[a-zA-Z][a-zA-Z\.]*[a-zA-Z]" />
										</p:inputText>
										<p:message for="emailUser" />
								</div>

								<div class="p-col-6">
										<p:outputLabel>Password</p:outputLabel>
										<p:inputText requiredMessage="Password is required!" value="#{clbHomeRegisterBean.user.password}"
											label="passwordUser" id="passwordUser" required="true" type="password"
											validatorMessage="Al least 6 characters are needed!">
											<f:validateLength minimum="6"></f:validateLength>
										</p:inputText>
										<p:message for="passwordUser" />
								</div>
								
								<div class="p-col-6">
										<p:outputLabel>Address</p:outputLabel>
										<p:inputTextarea rows="5" value="#{clbHomeRegisterBean.user.address}" class="textAreaRegForm"></p:inputTextarea>
								</div>
								

								
						<div class="p-col">


								<div class="p-col">
										<p:commandButton action="#{clbHomeRegisterBean.registerUserAccount}" validateClient="true"
										value="Sign Up" ajax="true" onstart="document.body.style.cursor='wait'"
									 oncomplete="
												 document.body.style.cursor='default';
												 if (!args.validationFailed){
													 document.body.style.cursor = 'default'; 
													 if (args.userExists === true ){ 
														 PF('unSuccessPanelalexistsUnsuccess').show();
													 }
													 else if (args.unexpectedError === true ){ 
														 PF('unSuccessPanelunexpectedUnsuccess').show();
													 }
													 else PF('successPanelregistry').show(); 
												 }" update="registerForm"/>
								</div>

							<div class="p-col">
									<p:commandButton oncomplete="PF('resendEmail').show()" value="Resend Registration Email"/>
							</div>

						<div class="p-col">
								<p:commandButton oncomplete="PF('recoverPassword').show()" value="Forget your password?" />
						</div>

							
						</div>
					</p:panel>
				</h:form>
			</div>
		</div>
		<ui:include src="./popups/recoverPassword.xhtml" />
		<ui:include src="./popups/resendEmail.xhtml" />
		<ui:include src="./popups/successDialog.xhtml">
			<ui:param name="id" value="registry"></ui:param>
			<ui:param name="successMessage"
				value="User was created successfully! Check your Email to Confirm Registration, if you dont receive an email in 24h please contact the staff." />
			<ui:param name="path" value="index.xhtml?faces-redirect=true" />
		</ui:include>
		<ui:include src="./popups/unSuccessDialog.xhtml">
			<ui:param name="idUnsuccess" value="doesnexistUnsuccess" />
			<ui:param name="unSuccessMessage" value="User does not exist!" />
		</ui:include>
		<ui:include src="./popups/unSuccessDialog.xhtml">
			<ui:param name="idUnsuccess" value="passwordnotmatchUnsuccess" />
			<ui:param name="unSuccessMessage" value="User passwords didnt match" />
		</ui:include>
		<ui:include src="./popups/unSuccessDialog.xhtml">
			<ui:param name="idUnsuccess" value="userNotEnabledYetUnsuccess" />
			<ui:param name="unSuccessMessage" value="Please validate user token before login." />
		</ui:include>
		<ui:include src="./popups/unSuccessDialog.xhtml">
			<ui:param name="idUnsuccess" value="alexistsUnsuccess" />
			<ui:param name="unSuccessMessage" value="User can't be registered because already exists" />
		</ui:include>
		<ui:include src="./popups/unSuccessDialog.xhtml">
			<ui:param name="idUnsuccess" value="unexpectedUnsuccess" />
			<ui:param name="unSuccessMessage"
				value="There was an error while saving User. Please contact support" />
		</ui:include>
		<ui:include src="./general/footer.xhtml" />
	</ui:define>
</ui:composition>